!function(i){var e=function(e,t){this.options=e||{},this.province="",this.city="",this.region="",this.provinceId="",this.cityId="",this.regionId="",this.h_provinceIndex=0,this.h_cityIndex=0,this.h_regionIndex=0,this.proSwiper=null,this.citySwiper=null,this.regionSwiper=null,this.$element=t,this.title=this.options.title||"选择地址",this.isSecondLevel=this.options.isSecondLevel||!1,this._complete=this.options.complete||function(){return!0},this._cancel=this.options.cancel||function(){},this._oninit=this.options.onInit||function(){},this._onProvinceChange=this.options.onProvinceChange||function(){},this._onCityChange=this.options.onCityChange||function(){},this._getProvinceList=this.options.getProvinceList||function(){},this._getCityList=this.options.getCityList||function(){},this._getRegionList=this.options.getRegionList||function(){},this._getRegionList=this.isSecondLevel?function(){}:this.options.getRegionList,this.$work=i("<div class='dym-address-picker'><div class='dym-address-area'><div class='title'><div class='cancel'><div class='bg'></div></div><div class='inner'>"+this.title+"</div><div class='complete'><div class='bg'></div></div></div><div class='main-container'></div></div></div>"),this.$address=i("<div class='dym-address'></div>");var n=this;this.$work.find(".cancel").off("click").on("click",function(){n.showByIndex(n.h_provinceIndex,n.h_cityIndex,n.h_regionIndex),n._cancel(),n.hide()}),this.$work.find(".complete").off("click").on("click",function(){var i=n._complete(n.getInfo());i&&n.hide(),n.h_provinceIndex=n.proSwiper.activeIndex,n.h_cityIndex=n.citySwiper.activeIndex,n.h_regionIndex=n.regionSwiper.activeIndex}),this.init(),this.hide()};e.prototype.init=function(){this.initFrame(),this.$work.find(".main-container").append(this.$address),this.$element.append(this.$work);var e=this,t=!1,n=!1,s=!1,d=function(){e._oninit(),e.hide()};this.proSwiper=new Swiper(this.$work.find(".address-province .warp"),{direction:"vertical",loop:!1,slidesPerView:5,onInit:function(n){e.provinceId=i(n.slides[n.activeIndex]).data("value")||"",e.province=i(n.slides[n.activeIndex]).html()||"",t=!0},onSlideChangeEnd:function(t){e.provinceId=i(t.slides[t.activeIndex]).data("value")||"",e.province=i(t.slides[t.activeIndex]).html()||"",e.city="",e.region="",e.refreshCityRegion(),e._onProvinceChange(e.province)},centeredSlides:!0}),this.citySwiper=new Swiper(this.$work.find(".address-city .warp"),{direction:"vertical",loop:!1,slidesPerView:5,onInit:function(t){e.cityId=i(t.slides[t.activeIndex]).data("value")||"",e.city=i(t.slides[t.activeIndex]).html()||"",n=!0},onSlideChangeEnd:function(t){e.cityId=i(t.slides[t.activeIndex]).data("value")||"",e.city=i(t.slides[t.activeIndex]).html()||"",e.region="",e.refreshRegion(),e._onCityChange(e.province,e.city)},centeredSlides:!0}),this.regionSwiper=new Swiper(this.$work.find(".address-region .warp"),{direction:"vertical",loop:!1,slidesPerView:5,onInit:function(t){e.regionId=i(t.slides[t.activeIndex]).data("value")||"",e.region=i(t.slides[t.activeIndex]).html()||"",s=!0},onSlideChangeEnd:function(t){e.regionId=i(t.slides[t.activeIndex]).data("value")||"",e.region=i(t.slides[t.activeIndex]).html()||""},centeredSlides:!0}),d()},e.prototype.initFrame=function(){var e=i("<div class='address-province'><div class=\"select\"></div><div class='warp'><div class='swiper-wrapper'></div></div></div>"),t=i("<div class='address-city'><div class=\"select\"></div><div class='warp'><div class='swiper-wrapper'></div></div></div>"),n=i("<div class='address-region'><div class=\"select\"></div><div class='warp'><div class='swiper-wrapper'></div></div></div>");this.isSecondLevel&&(e.addClass("second"),t.addClass("second"),n.addClass("second"));var s=this;s._getProvinceList(function(i){s.initProvice(e,i),s.$address.append(e),0==i.length&&i.push("北京"),s._getCityList(i[0].id,function(e){s.initCity(t,e),s.$address.append(t),0==e.length&&e.push(i[0]),s._getRegionList(i[0].id,e[0].id,function(i){s.initRegion(n,i),s.$address.append(n)})})})},e.prototype.initProvice=function(i,e){if(i.find(".swiper-wrapper").empty(),e)for(var t=0;t<e.length;t++)i.find(".swiper-wrapper").append("<div class='swiper-slide' data-value='"+e[t].id+"'>"+e[t].name+"</div>")},e.prototype.initCity=function(i,e){if(i.find(".swiper-wrapper").empty(),e)for(var t=0;t<e.length;t++)i.find(".swiper-wrapper").append("<div class='swiper-slide' data-value='"+e[t].id+"'>"+e[t].name+"</div>")},e.prototype.initRegion=function(i,e){if(!this.isSecondLevel&&(i.find(".swiper-wrapper").empty(),e))for(var t=0;t<e.length;t++)i.find(".swiper-wrapper").append("<div class='swiper-slide' data-value='"+e[t].id+"'>"+e[t].name+"</div>")},e.prototype.showByIndex=function(e,t,n){e=e||0,t=t||0,n=n||0;var s=this;this.proSwiper.slideTo(e),s.provinceId=i(s.proSwiper.slides[s.proSwiper.activeIndex]).data("value")||"",s.province=i(s.proSwiper.slides[s.proSwiper.activeIndex]).html()||"",s._getCityList(s.provinceId,function(e){s.initCity(s.$work.find(".address-city"),e),s.citySwiper.update(!0),s.citySwiper.slideTo(t),s.cityId=i(s.citySwiper.slides[s.citySwiper.activeIndex]).data("value")||"",s.city=i(s.citySwiper.slides[s.citySwiper.activeIndex]).html()||"",s._getRegionList(s.provinceId,s.cityId,function(e){s.initRegion(s.$work.find(".address-region"),e),s.regionSwiper.update(!0),s.regionSwiper.slideTo(n),s.regionId=i(s.regionSwiper.slides[s.regionSwiper.activeIndex]).data("value")||"",s.region=i(s.regionSwiper.slides[s.regionSwiper.activeIndex]).html()||""})})},e.prototype.refreshCityRegion=function(){var e=this;e._getCityList(e.provinceId,function(t){e.initCity(e.$work.find(".address-city"),t),e.citySwiper.update(!0),e.cityId=i(e.citySwiper.slides[e.citySwiper.activeIndex]).data("value")||"",e.city=i(e.citySwiper.slides[e.citySwiper.activeIndex]).html()||"",e._getRegionList(e.provinceId,e.cityId,function(t){e.initRegion(e.$work.find(".address-region"),t),e.regionSwiper.update(!0),e.regionId=i(e.regionSwiper.slides[e.regionSwiper.activeIndex]).data("value")||"",e.region=i(e.regionSwiper.slides[e.regionSwiper.activeIndex]).html()||""})})},e.prototype.refreshRegion=function(){var e=this;e._getRegionList(e.provinceId,e.cityId,function(t){e.initRegion(e.$work.find(".address-region"),t),e.regionSwiper.update(!0),e.regionId=i(e.regionSwiper.slides[e.regionSwiper.activeIndex]).data("value")||"",e.region=i(e.regionSwiper.slides[e.regionSwiper.activeIndex]).html()||""})},e.prototype.show=function(){this.$work.show(),this.showByIndex(this.h_provinceIndex,this.h_cityIndex,this.h_regionIndex),this.proSwiper.update(!0),this.citySwiper.update(!0),this.isSecondLevel||this.regionSwiper.update(!0)},e.prototype.hide=function(){this.$work.hide()},e.prototype.getInfo=function(){return{province:this.province,city:this.city,region:this.region,provinceId:this.provinceId,cityId:this.cityId,regionId:this.regionId}},i.fn.address=function(t){var n=i(this);return new e(t,n)}}(Zepto);